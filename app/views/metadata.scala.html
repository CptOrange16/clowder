@(dataset_id: String, metadata: List[Map[String,Any]], userMetadata: scala.collection.mutable.Map[String,Any])

@import com.mongodb.casbah.Imports.DBObject
@import collection.JavaConverters._

<form class="form-inline">

@printLevel(metadata: Map[String,Any]) = {
	<ul>
	@for((key,value) <- metadata) {
		<li><b>@(key):</b>
		@if(value.isInstanceOf[String]) {
			@value
		} else {
				@printLevel(value.asInstanceOf[Map[String, Any]])
		}</li>
	}
	</ul>
} 
@printLevelUserMetadata(metadata: scala.collection.mutable.Map[String,Any]) = {
	<ul class="usr_md_">
	@for((key,value) <- metadata) {
		<li class="usr_md_"><b class="usr_md_">@(key.replaceAll("__[0-9]*","")):</b>
		@if(value.isInstanceOf[String]) {
			<span class="usr_md_">@value</span><button class="usr_md_" type="button">Modify</button><button class="usr_md_" >Delete</button>
		} else {
				<button class="usr_md_" type="button">Add property</button><button class="usr_md_" type="button">Delete</button>@printLevelUserMetadata(value.asInstanceOf[DBObject].toMap.asScala.asInstanceOf[scala.collection.mutable.Map[String, Any]])
		}</li>
	}
	</ul>
}

<h5>Auto-generated metadata:</h5>

@if(metadata.isEmpty) {
	<div>No auto-generated metadata.</div>
} else {
	@for(md <- metadata) {
			<div>@printLevel(md)</div>
	}
}
<br />
<h5>User metadata:</h5>

		<div id='datasetUserMetadata' class='usr_md_'><button class="usr_md_" type="button">Add property</button>@printLevelUserMetadata(userMetadata)<button class="usr_md_submit btn" type="button">Submit</button></div>
		
		
</form>
<script language="javascript">
	var hostIp = "@api.routes.Datasets.addUserMetadata(dataset_id)";
</script>
<script src="@routes.Assets.at("javascripts/userMetadata.js")" type="text/javascript"></script>
