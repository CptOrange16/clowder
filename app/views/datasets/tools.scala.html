@(sessions: List[UUID], sessionMap: scala.collection.mutable.Map[UUID, String], sessionDsMap: scala.collection.mutable.Map[UUID, List[scala.collection.mutable.Map[String,String]]], datasetid:UUID)(implicit user: Option[models.User])

@import api.Permission

<div class="row border-top bottom-padding">
  <div class="col-md-12">
    <h4>Running Tool Sessions</h4>
  </div>
</div>

<div class="row">
  <div class="col-md-12">

    <div id="toolsList">
      @sessions.map { sess =>
        <div id="col_@sess" class="row bottom-padding">
          <div class="col-md-10">
            <div>
              @{
                val linkstr = sessionMap.get(sess) match {
                  case Some(s) => {
                    if (s == "") { sess+" (not yet ready)" }
                    else { "<a href="+s+">"+sess+"</a>" }
                  }
                  case None => ""
                }
                Html(linkstr)
              }
            </div>
            <div>
              @sessionDsMap.get(sess) match {
                case Some(ds_list) => {
                  @if(ds_list.length ==1) {
                    1 dataset
                  } else {
                    @ds_list.length datasets
                  }
                }
                case None => {
                  No datasets
                }
              }
              @if(Permission.checkPermission(Permission.ExecuteOnDataset, ResourceRef(ResourceRef.dataset, datasetid))) {
                | <a href="#" class="btn btn-link btn-xs" title="Attach current dataset">
                  <span class="glyphicon glyphicon-remove"></span>Attach This Dataset</a>
              } else {
                |  <a href="#" class="btn btn-link btn-xs disabled" title="Attach current dataset">
                  <span class="glyphicon glyphicon-remove"></span>Attach This Dataset</a>
              }
            </div>
          </div>
        </div>
      }
    </div>
</div>

<div class="row bottom-padding">
  <div class="col-md-12">
    <a class="btn btn-link" onclick="refreshToolSidebar()">
      <span class="glyphicon glyphicon-log-in"></span>&nbsp;Refresh List
    </a>
    <a class="btn btn-link" href="toolManager">
      <span class="glyphicon glyphicon-log-in"></span>&nbsp;Go to Tool Manager
    </a>
  </div>
</div>

