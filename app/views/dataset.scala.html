@(dataset: models.Dataset, previewers: Array[Previewer]) 

@main("Dataset") {

    <script src="@routes.Assets.at("javascripts/previews.js")" type="text/javascript"></script>
    
	<div class="page-header">
		<h1>@dataset.name</h1>
	</div>
	<div class="row-fluid">
		
		<div class="span8">
			<div class="tabbable">
				<ul class="nav nav-pills" id="myTab">
				@dataset.files.map { f =>
					@if(f.contentType.equals("image/jpeg")){
					<li class=""><a href="#previewer_Thumbnail" data-toggle="tab">Thumbnail</a></li>
					}
				}
				@dataset.files.map { f =>
					@previewers.map { p =>
						@if(p.contentType.contains(f.contentType)) {
				  		<li class=""><a href="#previewer_@p.id" data-toggle="tab">@p.id</a></li>
				  		}
				    }
				}
				</ul>
				<div class="tab-content">
				@dataset.files.map { f =>
					@if(f.contentType.equals("image/jpeg")){
					<img src="@routes.Files.file(f.id.toString)/blob" class="img-polaroid" width="500px"></img>
					}
				}
				@dataset.files.map { f =>
					@previewers.map { p =>
						@if(p.contentType.contains(f.contentType)) {
    					<div class="tab-pane" id="previewer_@p.id"></div>
    					<script>
							var Configuration = {};
							Configuration.id = "@dataset.id";
							Configuration.url = "@routes.Files.file(dataset.files(0).id.toString)" + "/blob";
						</script>
						<script type="text/javascript" src="@(routes.Assets.at(p.path) + "/" + p.main)"></script>
				  		}
				  	}
				  	<div id="galleria" style="float:left;clear:none;width:300px;height:300px;">
				  	@f.sections.map { s =>
				  		<div>@s.order @s.startTime</div>
				  		<img src="@api.routes.Previews.download(s.preview.get.id.toString)?key=letmein" class="img-polaroid" height="100px"></img>
				  	}
				  	</div>
    			}
	  			</div>
			</div>
  			<script type="text/javascript">
				$(function () {
    				$('#myTab a:first').tab('show');
 				 })
			</script>
		</div>
		
		<div class="span4">
		    <div class="row">
				<dl>
					<dt>Name:</dt>
					<dd>@dataset.name</dd>
					<dt>Description:</dt>
					<dd>@dataset.description</dd>
				    <dt>Created:</dt>
					<dd>@dataset.created</dd>
				</dl>
			</div>
			
			<div class="row">
				<h5>Files</h5>
				@dataset.files.map { file =>
				<div><a href="@(routes.Files.file(file.id.toString))" title="@file.contentType">@file.filename</a></div>
				}
			</div>
			
			<div class="row">
				<h5>Tags</h5>
				<ul id="tagList">
					@dataset.tags.map { tag =>
					  <li>@tag</li>
					}
				</ul>
				<input type="text" placeholder="Text input" id="tagField">
				<button class="btn" id="tagB">Tag</button>
				<script language="javascript">
				$(function() {
				   $('#tagB').click(function() {
				     var tag = $('#tagField').val();
				     console.log("submitting tag " + tag);
				     console.log("@routes.Tags.tag");
				     
				     var request = jsRoutes.controllers.Tags.tag().ajax({
				       data: JSON.stringify({"id":"@dataset.id","tag":tag}),
				       type: 'POST',
				       contentType: "application/json",
				     });
				     
				     request.done(function (response, textStatus, jqXHR){
				        console.log("Response " + response);
				        $('#tagList').append('<li>' + tag + '</li>');
				     });
		    
				     request.fail(function (jqXHR, textStatus, errorThrown){
				        console.error(
				            "The following error occured: "+
				            textStatus, errorThrown
				        );
				     });
				  });
				 });
			     </script>
			</div>
		</div>
		
	<script src="http://popcornjs.org/code/dist/popcorn-complete.min.js" type="text/javascript"></script>	
    <script src="@routes.Assets.at("javascripts/galleria-1.2.9.js")" type="text/javascript"></script>
    <script>
    	$(function() {
		    // Load the classic theme
		    Galleria.loadTheme('@routes.Assets.at("javascripts/galleria-classic/galleria.classic.min.js")');
		
		    // Initialize Galleria
		    Galleria.run('#galleria');
		    
		    var gallery = $('#galleria').data('galleria');
		    

	      	
	      	
	    });
    </script>
		
	</div>
}
