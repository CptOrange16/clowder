@(file_id: String, userMetadata: scala.collection.mutable.Map[String,Any])(implicit user: Option[securesocial.core.Identity]) 

@import com.mongodb.casbah.Imports.DBObject
@import collection.JavaConverters._

<br/>
<form class="form-inline">	
	@printLevelUserMetadata(metadata: scala.collection.mutable.Map[String,Any]) = {
		<ul class="usr_md_">
		@for((key,value) <- metadata) {
			<li class="usr_md_"><b class="usr_md_">@(key.replaceAll("__[0-9]*$","")):</b>
			@if(value.isInstanceOf[String]) {			
				<span class="usr_md_">@value</span><button class="usr_md_" type="button">Modify</button><button class="usr_md_" >Delete</button>
			} else {
					<button class="usr_md_" type="button">Add property</button><button class="usr_md_" type="button">Delete</button>@printLevelUserMetadata(value.asInstanceOf[DBObject].toMap.asScala.asInstanceOf[scala.collection.mutable.Map[String, Any]])
			}</li>
		}
		</ul>
	}
	
	<div id='generalUserMetadata_@(file_id)' class='usr_md_'><button class="usr_md_" type="button">Add property</button>@printLevelUserMetadata(userMetadata)<button class="usr_md_submit btn" type="button">Submit</button></div>		
</form>
<script language="javascript">
	var topId = "generalUserMetadata_@(file_id)"; 
	window["uploadIp"+topId] = "@api.routes.Files.addUserMetadata(file_id)";
	window["modelIp"+topId] = "@(routes.Assets.at("filesUserMetadataModel"))";
</script>
<script src="@routes.Assets.at("javascripts/userMetadata.js")" type="text/javascript"></script>
@if(!user.isDefined) {
		      	   <script language="javascript">
			     		$("#generalUserMetadata_@(file_id) button").css("display","none");
			       </script>
		      	}
