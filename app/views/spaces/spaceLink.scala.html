@(resourceSpaces: Option[List[ProjectSpace]], resourceType: Symbol, resourceId: UUID)(implicit user: Option[models.User])
@import api.Permission
<span id="spaces" >
@if(user.isDefined) {
    @if(resourceSpaces.isDefined) {
        @for(sp <- resourceSpaces) {
            @for(s <- sp) {
                <a class= 'space-pills' href="@routes.Spaces.getSpace(s.id)" id="space_link">
                @s.name</a>
            }
        }

        @*<a href="javascript:changeSpace('@resourceId', @resourceType)">*@
            @*<span class="glyphicon glyphicon-edit" aria-hidden="true"></span>*@
        @*</a>*@
        <!-- If the user can add resources to the space for this resource, the link is enabled, otherwise the button is present but disabled to provide consistent UE. -->
        @if(Permission.checkPermission(Permission.AddResourceToSpace, ResourceRef(resourceType, resourceId))) {
            <button class = "btn btn-link btn-xs accordion-toggle collapsed" data-toggle="modal"
            data-target="#modalSpaces" id="editSpaces" title = "Edit Spaces">
                <span class = "glyphicon glyphicon-edit" aria-hidden="true"></span>
            </button>
        } else {
            <button class = "btn btn-link btn-xs accordion-toggle collapsed disabled" data-toggle="modal"
            data-target="#modalSpaces" id="editSpaces" title = "Edit Spaces">
                <span class = "glyphicon glyphicon-edit" aria-hidden="true"></span>
            </button>
        }
    }
    @if(resourceSpaces.isEmpty) {
        <a href="#" id="space_link">Default</a>
        @if(resourceType == ResourceRef.dataset) {
            <a href="javascript:changeSpace('@resourceId', 0)">
                <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
            </a>
        } else { @if(resourceType == ResourceRef.collection) {
            <a href="javascript:changeSpace('@resourceId', 1)">
                <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
            </a>
        }}
    }
}
@if(user.isEmpty) {
    @if(!resourceSpaces.isEmpty) {
        @for(sp <- resourceSpaces) {
            @for(s <- sp) {
                <a class= 'space-pills' href="@routes.Spaces.getSpace(s.id)" id="space_link">
                @s.name</a>
            }
        }
    }

    @if(resourceSpaces.isEmpty) {
        <a href="#" id="space_link">Default</a>
    }
}
</span>
<div class = "modal fade bs-example-modal-lg" id = "modalSpaces" tabindex = "-1" role = " dialog"
aria-labelledby="myModalLabel" aria-hidden="true">
    <div class ="modal-dialog">
        <div class = "modal-content">
            <div class = "modal-header">
                <button type = "button" class = "close" data-dismiss="modal" aria-hidden="true"> &times;</button>
                <h4 class = "modal-title">Edit Spaces</h4>
            </div>
            <div class = "modal-body" style= "padding-left: 30px;">

                @spaces.spaceAllocation(resourceId, resourceType,  resourceSpaces)
            </div>
            <div class ="modal-footer">
                <button class ="btn btn-primary" id="spaces_add" title = "Update Spaces Information">
                    <span class ="glyphicon glyphico-edit"></span> Submit
                </button>
                <a href="#" class ="btn btn-default" id = "closebutton" data-dismiss="modal">Close</a>
            </div>
        </div>
    </div>

</div>
<script src="@routes.Assets.at("javascripts/handlebars-v1.3.0.js")" type="text/javascript"></script>
<script src="@routes.Assets.at("javascripts/handlebars-loader.js")" type="text/javascript"></script>
<script src="@routes.Assets.at("javascripts/spaceModify.js")" type="text/javascript"></script>