@(theme: String, displayName: String, welcomeMessage: String, userAgreement: String, sensors: String, sensor: String, parameters: String, parameter: String)(implicit user: Option[models.User])
@main("Administration") {
	<div class="page-header">
		<h1>Customize</h1>
	</div>
	
	<legend>Select a Theme</legend>
	
	<div class="row">
		<div class="col-md-2">@themes(theme)</div>
	</div>
	
	<legend>Select a display name for the application and a welcoming message</legend>
	
	<div class="row">
		<div class="col-md-2">
			<form role="form-horizontal">
			  <div class="form-group">
			    <label for="displayNameField">Display name</label>
			    <input class="form-control" id="displayNameField" name="displayNameField" type="text" value="@(displayName)"></input>
			    <span id="displayNameField_error" style="display:none;">Must have a display name</span>
			    <br /><br />
			    <label for="welcomingField">Welcoming message</label>
				<textarea class="form-control" name="welcomingField" id="welcomingField" style="width:300%;">@(welcomeMessage)</textarea>
				<br /><br />
                <label for="userAgreement">User Agreement</label>
                <textarea class="form-control" name="userAgreement" id="userAgreement" style="width:300%;">@(userAgreement)</textarea>
                <br /><br />
                  @play.api.Play.current.plugin[services.PostgresPlugin] match {
                    case Some(db) => {
                      <label for="sensorsTitle">Sensors title (plural form)</label>
                      <input id="sensorsTitle" name="sensorsTitle" type="text" value="@(sensors)" />
                      <span id="sensorsTitle_error" style="display:none;">Sensors must have a title.</span>
                      <label for="sensorTitle">Sensor title (singular form)</label>
                      <input id="sensorTitle" name="sensorTitle" type="text" value="@(sensor)" />
                      <span id="sensorTitle_error" style="display:none;">Sensor must have a title.</span>
                      <br /><br />
                      <label for="parametersTitle">Parameters title (plural form)</label>
                      <input id="parametersTitle" name="parametersTitle" type="text" value="@(parameters)" />
                      <span id="parametersTitle_error" style="display:none;">Parameters must have a title.</span>
                      <label for="parameterTitle">Parameter title (singular form)</label>
                      <input id="parameterTitle" name="parameterTitle" type="text" value="@(parameter)" />
                      <span id="parameterTitle_error" style="display:none;">Parameter must have a title.</span>
                      <br /><br />
                    }
                    case None => {}
                }

			    <button class="btn btn-primary" onclick="return submitAppearance();"><span class="glyphicon glyphicon-saved"></span> Submit</button>
			  </div>
			</form>			
		</div>
	</div>
	<script language="javascript">
		function submitAppearance(){
			var displayName = $("#displayNameField").val().trim();
			var welcomeMessage = $("#welcomingField").val().trim();
            var userAgreement = $("#userAgreement").val() ? $("#userAgreement").val().trim() : "";
			var sensorsTitle = $("#sensorsTitle").val() ? $("#sensorsTitle").val().trim() : "";
            var sensorTitle = $("#sensorTitle").val() ? $("#sensorTitle").val().trim() : "";
            var parametersTitle = $("#parametersTitle").val() ? $("#parametersTitle").val().trim() : "";
            var parameterTitle = $("#parameterTitle").val() ? $("#parameterTitle").val().trim() : "";

			if(displayName == ""){
				$("#displayNameField_error").css("display","inline");
				return false;
			}else{
				$("#displayNameField_error").css("display","none");
			}
			
			console.log("Display name: "+displayName);
			console.log("Welcoming message: "+welcomeMessage);
			
			var request = $.ajax({
				url:  "@api.routes.Admin.submitAppearance",
				data: JSON.stringify({displayName: displayName, welcomeMessage: welcomeMessage, userAgreement: userAgreement, sensors: sensorsTitle, sensor: sensorTitle, parameters: parametersTitle, parameter: parameterTitle }),
				type: "POST",
				contentType: "application/json"
	     	});
			request.done(function (response, textStatus, jqXHR){ 
				console.log("Response: " + response);
				notify("Preferences successfully updated. Please refresh page.", "success", 5000);
			});
			request.fail(function (jqXHR, textStatus, errorThrown){
				console.error("The following error occured: " + textStatus, errorThrown);
				notify("The application preferences was not updated due to : " + errorThrown, "error");
			});						
			return false;
		}
	</script>
}
